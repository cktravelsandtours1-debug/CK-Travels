<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | CK Travels</title>

    <link rel="stylesheet" href="css/main.css">

    <style>
        .dashboard-card {
            background: #fff;
            border: var(--sh-border);
            border-radius: 8px;
            padding: 24px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--sh-black);
        }

        .admin-sidebar {
            background: #fdfdfd;
            border-right: 1px solid #eee;
            height: calc(100vh - 72px);
            padding: 24px 0;
        }

        .admin-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            color: #444;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
        }

        .admin-nav-item:hover,
        .admin-nav-item.active {
            background: #f0f0f0;
            color: var(--color-primary);
        }

        .admin-content {
            padding: 32px;
            background: #fbfbfb;
            min-height: calc(100vh - 72px);
        }
    </style>
</head>

<body>

    <nav class="navbar">
        <a href="index.html" class="logo">CK Travels <span
                style="font-size: 0.7rem; color: var(--color-primary); font-weight: 800; vertical-align: middle; margin-left: 4px; border: 1px solid var(--color-primary); padding: 2px 4px; border-radius: 4px;">ADMIN</span></a>
        <div class="nav-links">
            <a href="index.html" class="nav-item">Home</a>
            <a href="flights.html" class="nav-item">Flights</a>
            <a href="packages.html" class="nav-item">Packages</a>
            <a href="admin-dashboard.html" class="nav-item active">Dashboard</a>
        </div>
        <div style="display: flex; gap: 12px; align-items: center;">
            <span id="admin-name" style="font-weight: 600; font-size: 0.9rem;">Admin</span>
            <a href="#" onclick="handleLogout(event)" class="btn btn-secondary btn-sm">Logout</a>
        </div>
    </nav>

    <div style="display: grid; grid-template-columns: 240px 1fr;">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <a href="admin-dashboard.html" class="admin-nav-item active">
                <span>üìä</span> Overview
            </a>
            <a href="admin-bookings.html" class="admin-nav-item">
                <span>üé´</span> Bookings
            </a>
            <a href="admin-flights.html" class="admin-nav-item">
                <span>‚úàÔ∏è</span> Manage Flights
            </a>
            <a href="admin-packages.html" class="admin-nav-item">
                <span>üó∫Ô∏è</span> Manage Packages
            </a>
            <div style="margin-top: auto; padding: 24px;">
                <p style="font-size: 0.75rem; color: #999;">Logged in as Admin</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                <div>
                    <h1 style="font-size: 2rem;">Overview</h1>
                    <div style="color: #666; font-size: 0.9rem;">Welcome back, Administrator</div>
                </div>
                <button class="btn btn-secondary btn-sm" onclick="clearData()"
                    style="color: #ef4444; border-color: #fee2e2;">üóëÔ∏è Clear All Data</button>
            </div>

            <!-- Stats Grid -->
            <div class="grid-3" style="margin-bottom: 40px; gap: 24px;">
                <div class="dashboard-card shadow-sm">
                    <div class="stat-label">Total Bookings</div>
                    <div class="stat-value" id="total-bookings">0</div>
                    <div style="color: #10b981; font-size: 0.8rem; margin-top: 4px;">Real-time update</div>
                </div>
                <div class="dashboard-card shadow-sm">
                    <div class="stat-label">Total Revenue</div>
                    <div class="stat-value" id="total-revenue">$0</div>
                    <div style="color: #10b981; font-size: 0.8rem; margin-top: 4px;">Estimate</div>
                </div>
                <div class="dashboard-card shadow-sm">
                    <div class="stat-label">Active Users</div>
                    <div class="stat-value">--</div>
                    <div style="color: #3b82f6; font-size: 0.8rem; margin-top: 4px;">Guests</div>
                </div>
            </div>

            <div class="grid-2" style="gap: 24px;">
                <!-- Recent Bookings Table -->
                <div class="dashboard-card shadow-sm" style="grid-column: span 2;">
                    <h2 style="font-size: 1.2rem; margin-bottom: 20px;">Recent Bookings</h2>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 1px solid #eee;">
                                <th style="padding: 12px 0; color: #666; font-size: 0.9rem;">ID</th>
                                <th style="padding: 12px 0; color: #666; font-size: 0.9rem;">Customer</th>
                                <th style="padding: 12px 0; color: #666; font-size: 0.9rem;">Service</th>
                                <th style="padding: 12px 0; color: #666; font-size: 0.9rem;">Date</th>
                                <th style="padding: 12px 0; color: #666; font-size: 0.9rem;">Status</th>
                            </tr>
                        </thead>
                        <tbody id="recent-bookings-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Inline Auth Logic
        function logout() {
            localStorage.removeItem('ck_travels_user');
            window.location.href = 'index.html';
        }

        function checkAuth() {
            const user = JSON.parse(localStorage.getItem('ck_travels_user') || 'null');
            // Simplified check
        }

        // Mock data if empty
        const mockBookings = [
            { id: 'b-mock1', customer: 'Sample User', email: 'test@user.com', item: 'Demo Flight', type: 'Flight', date: 'Oct 24, 2026', price: 500, status: 'Pending' }
        ];

        function renderDashboard() {
            // Get bookings
            const bookings = JSON.parse(localStorage.getItem('ck_bookings') || '[]');

            // Calculate Stats
            document.getElementById('total-bookings').textContent = bookings.length;

            const revenue = bookings.reduce((sum, b) => sum + (Number(b.price) || 0), 0);
            document.getElementById('total-revenue').textContent = '$' + revenue.toLocaleString();

            // Render Table (Recent 5)
            const tbody = document.getElementById('recent-bookings-body');
            tbody.innerHTML = '';

            const recent = bookings.slice(0, 5); // display first 5

            if (recent.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="padding:20px; text-align:center; color:#999;">No bookings yet. Go make one!</td></tr>';
            }

            recent.forEach(b => {
                let statusColor = '#dcfce7'; // green
                let statusText = '#166534';
                if (b.status === 'Pending') { statusColor = '#fef9c3'; statusText = '#854d0e'; }
                if (b.status === 'Cancelled') { statusColor = '#fee2e2'; statusText = '#991b1b'; }

                const tr = document.createElement('tr');
                tr.style.borderBottom = '1px solid #f9f9f9';
                tr.innerHTML = `
                    <td style="padding: 12px 0; font-weight: 600;">#${b.id.substring(b.id.length - 4)}</td>
                    <td style="padding: 12px 0;">${b.customer}</td>
                    <td style="padding: 12px 0;">${b.item}</td>
                    <td style="padding: 12px 0; font-size: 0.85rem; color: #666;">${b.date}</td>
                    <td style="padding: 12px 0;"><span
                            style="background: ${statusColor}; color: ${statusText}; padding: 2px 8px; border-radius: 99px; font-size: 0.75rem;">${b.status}</span>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        window.clearData = function () {
            if (confirm("Are you sure you want to clear ALL bookings? This cannot be undone.")) {
                localStorage.removeItem('ck_bookings');
                renderDashboard();
            }
        }

        window.handleLogout = function (e) {
            e.preventDefault();
            logout();
        }

        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            renderDashboard();
        });
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Flight Inventory | CK Travels Nautical</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- GSAP Master Stack -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.33/dist/lenis.min.js"></script>

    <!-- Design System -->
    <link rel="stylesheet" href="css/main.css">

    <style>
        .stack-item {
            position: sticky;
            top: 250px;
            transition: all 0.5s var(--ease-expo);
        }

        .glass-2 {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 40px 100px -20px rgba(0, 0, 0, 0.4);
        }

        .glass-2:hover {
            border-color: #FF6B00;
            box-shadow: 0 0 20px rgba(255, 107, 0, 0.3);
        }

        .btn-orange {
            background-color: #FF6B00;
            color: white;
            transition: all 0.4s var(--ease-expo);
        }

        .btn-orange:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 107, 0, 0.3);
        }

        #page-curtain {
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            height: 100%;
            background-color: #FF6B00;
            z-index: 9999;
            pointer-events: none;
        }

        .path-svg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 80px;
            pointer-events: none;
            overflow: visible;
        }

        .airplane-icon {
            fill: #FF6B00;
        }

        .flight-card-inner {
            background: white;
            border-radius: 40px;
            padding: 60px;
            border: 1px solid #f1f5f9;
        }

        .mobile-tab-bar {
            background: rgba(0, 20, 61, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body class="bg-slate-50 font-body text-[#00143D] antialiased">

    <!-- Page Transition Curtain -->
    <div id="page-curtain"></div>

    <!-- Desktop Nav Dock -->
    <nav id="main-nav"
        class="fixed top-8 left-1/2 -translate-x-1/2 w-[90%] max-w-7xl z-50 px-10 py-5 rounded-[40px] transition-all duration-700 glass-2 hidden lg:flex items-center justify-between">
        <a href="index.html" class="flex items-center gap-1 group">
            <span class="text-3xl font-black tracking-tighter italic text-[#00143D]">CK<span
                    class="text-[#FF6B00] not-italic">.</span></span>
        </a>

        <div class="flex items-center gap-12 font-bold text-[11px] tracking-[0.3em] uppercase opacity-60">
            <a href="index.html" class="hover:text-[#FF6B00] transition-colors">Home</a>
            <a href="flights.html" class="text-[#FF6B00]">Flights</a>
            <a href="packages.html" class="hover:text-[#FF6B00] transition-colors">Packages</a>
            <a href="booking.html" class="hover:text-[#FF6B00] transition-colors">My Trips</a>
        </div>

        <div class="flex items-center gap-6">
            <a href="login.html" class="text-[11px] font-black tracking-[0.3em] uppercase text-[#00143D]">Member
                Link</a>
            <a href="flights.html"
                class="btn-orange px-8 py-4 rounded-full text-[11px] font-black tracking-[0.3em] uppercase transition-all shadow-xl">Book
                Now</a>
        </div>
    </nav>

    <!-- Asset Header -->
    <header class="pt-48 pb-12 bg-[#00143D]">
        <div class="max-w-7xl mx-auto px-6">
            <div
                class="glass-2 p-12 rounded-[64px] flex flex-col lg:flex-row items-center justify-between gap-12 reveal-up">
                <div class="flex items-center gap-16">
                    <div class="space-y-4">
                        <p class="text-[10px] font-black tracking-[0.5em] text-[#FF6B00] uppercase">Mission Region</p>
                        <div class="text-6xl font-heading font-black italic text-white flex items-center gap-6">
                            DXB <span class="not-italic text-sm text-slate-500">â†’</span> LHR
                        </div>
                    </div>
                    <div class="w-px h-20 bg-white/10 hidden md:block"></div>
                    <div class="space-y-4">
                        <p class="text-[10px] font-black tracking-[0.5em] text-slate-500 uppercase">Synchronized Window
                        </p>
                        <div class="text-3xl font-black italic text-white">24 OCT, 2026</div>
                    </div>
                </div>

                <div class="bg-white/5 p-2 rounded-full flex gap-2">
                    <button
                        class="px-10 py-5 bg-[#FF6B00] text-white rounded-full text-[10px] font-black tracking-widest uppercase shadow-xl">Most
                        Economical</button>
                    <button
                        class="px-10 py-5 hover:bg-white/5 text-slate-400 hover:text-white rounded-full text-[10px] font-black tracking-widest uppercase transition-all">Rapid
                        Transit</button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-32 flex flex-col lg:flex-row gap-20">

        <!-- Interactive Sidebar -->
        <aside class="w-full lg:w-80 space-y-12 reveal-left">
            <div class="bg-white p-10 rounded-[48px] border border-slate-100 shadow-sm sticky top-40">
                <h3 class="text-[11px] font-black tracking-[0.5em] text-[#00143D] uppercase mb-10">Refine Matrix</h3>

                <div class="space-y-12">
                    <div class="space-y-6">
                        <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest">Pricing
                            Ceiling</label>
                        <input type="range"
                            class="w-full accent-[#FF6B00] bg-slate-100 h-1.5 rounded-full cursor-pointer">
                    </div>

                    <div class="space-y-4">
                        <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest">Routing
                            Protocol</label>
                        <div class="space-y-5">
                            <label class="flex items-center gap-4 cursor-pointer group">
                                <div
                                    class="w-6 h-6 rounded-lg bg-orange-600/10 border border-orange-600/30 flex items-center justify-center text-[#FF6B00]">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path d="M5 13l4 4L19 7" stroke-width="4" />
                                    </svg>
                                </div>
                                <span
                                    class="text-sm font-bold text-slate-600 group-hover:text-[#00143D] transition-colors">Direct
                                    Deployment</span>
                            </label>
                            <label class="flex items-center gap-4 cursor-pointer group">
                                <div class="w-6 h-6 rounded-lg bg-slate-100 border border-slate-200"></div>
                                <span
                                    class="text-sm font-bold text-slate-600 group-hover:text-[#00143D] transition-colors">Multimodal
                                    Stops</span>
                            </label>
                        </div>
                    </div>

                    <button
                        class="w-full py-5 bg-[#00143D] text-white rounded-[24px] text-[10px] font-black tracking-widest uppercase shadow-xl hover:bg-black transition-all">Execute
                        Filters</button>
                </div>
            </div>
        </aside>

        <!-- Stacking Results Stream -->
        <div id="results-stack" class="flex-1 space-y-8 pb-[100vh]">
            <div class="flex justify-between items-end mb-16 reveal-up">
                <h2 class="text-6xl font-heading font-black italic text-[#00143D]">Live <span
                        class="not-italic text-slate-200">Inventory.</span></h2>
                <span id="results-count"
                    class="text-[10px] font-black text-[#FF6B00] tracking-[0.4em] uppercase">Authenticating
                    Nodes...</span>
            </div>

            <div id="stack-container" class="space-y-12">
                <!-- Data injection point -->
                <div class="h-64 bg-slate-200 rounded-[48px] animate-pulse"></div>
                <div class="h-64 bg-slate-200 rounded-[48px] animate-pulse"></div>
                <div class="h-64 bg-slate-200 rounded-[48px] animate-pulse"></div>
            </div>
        </div>
    </main>

    <!-- Mobile Nav -->
    <div class="lg:hidden fixed bottom-0 w-full z-50 px-6 pb-8 pt-4 mobile-tab-bar text-white">
        <div class="flex justify-between items-center opacity-40">
            <a href="index.html" class="flex flex-col items-center gap-1">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                <span class="text-[8px] font-black uppercase tracking-widest">Home</span>
            </a>
            <a href="flights.html" class="flex flex-col items-center gap-1 text-[#FF6B00] opacity-100">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z" />
                </svg>
                <span class="text-[8px] font-black uppercase tracking-widest">Flights</span>
            </a>
            <a href="booking.html" class="flex flex-col items-center gap-1">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M19 3h-1V1h-2v2H8V1H6v3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z" />
                </svg>
                <span class="text-[8px] font-black uppercase tracking-widest">Trips</span>
            </a>
        </div>
    </div>

    <!-- Firebase Connection -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger, MotionPathPlugin);

        const lenis = new Lenis()
        function raf(time) { lenis.raf(time); requestAnimationFrame(raf); }
        requestAnimationFrame(raf);

        const firebaseConfig = {
            apiKey: "AIzaSyBsrtZh0PBOjNA8c8-9sifdtVqKMk7q-fs",
            authDomain: "ck-travels-8926e.firebaseapp.com",
            projectId: "ck-travels-8926e",
            storageBucket: "ck-travels-8926e.firebasestorage.app",
            messagingSenderId: "310809428136",
            appId: "1:310809428136:web:74e2b0216f58088cf3829d",
            measurementId: "G-HNT07JXC3C"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        db.settings({ experimentalForceLongPolling: true });

        const container = document.getElementById('stack-container');

        db.collection("flights").get().then(qs => {
            container.innerHTML = '';
            document.getElementById('results-count').textContent = qs.size + ' ACTIVE NODES';

            qs.forEach((doc, index) => {
                const f = doc.data();
                const cardId = `card-${doc.id}`;
                const pathId = `path-${doc.id}`;

                container.innerHTML += `
                    <div id="${cardId}" class="stack-item">
                        <div class="flight-card-inner shadow-[0_40px_100px_-20px_rgba(0,0,0,0.08)] group hover:border-[#FF6B00] transition-colors">
                            <div class="flex flex-col md:flex-row items-center gap-16 relative">
                                <!-- Logic Provider -->
                                <div class="w-full md:w-48 text-center md:text-left">
                                    <div class="w-24 h-24 bg-slate-50 rounded-[32px] flex items-center justify-center font-black text-[#00143D] text-2xl border border-slate-100 group-hover:bg-orange-600 group-hover:text-white transition-all duration-700 mx-auto md:mx-0">
                                        ${f.airline.substring(0, 2).toUpperCase()}
                                    </div>
                                    <div class="mt-8">
                                        <h4 class="font-black text-[#00143D] italic text-lg tracking-tighter">${f.airline}</h4>
                                        <span class="text-[9px] font-black text-slate-400 uppercase tracking-widest italic">${f.aircraft || 'Vogue Class'}</span>
                                    </div>
                                </div>

                                <!-- Interactive Path Interface -->
                                <div class="flex-1 flex flex-col items-center w-full px-12 relative overflow-visible">
                                    <div class="flex justify-between items-center w-full relative z-10">
                                        <div class="text-center md:text-left">
                                            <div class="text-5xl font-heading font-black text-[#00143D] italic mb-2">${f.departure}</div>
                                            <div class="text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]">${f.from.split(' ')[0]}</div>
                                        </div>
                                        
                                        <div class="flex-1 px-20"></div>

                                        <div class="text-center md:text-right">
                                            <div class="text-5xl font-heading font-black text-[#00143D] italic mb-2">${f.arrival}</div>
                                            <div class="text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]">${f.to.split(' ')[0]}</div>
                                        </div>
                                    </div>

                                    <!-- Motion Path SVG -->
                                    <svg class="path-svg" viewBox="0 0 400 100">
                                        <path id="${pathId}" d="M40,50 Q200,-20 360,50" class="fill-none stroke-slate-100" stroke-width="2" stroke-dasharray="8 8" />
                                        <circle class="airplane-icon" r="6">
                                            <animateMotion dur="4s" repeatCount="indefinite">
                                                <mpath href="#${pathId}"/>
                                            </animateMotion>
                                        </circle>
                                    </svg>
                                </div>

                                <!-- Valuation -->
                                <div class="w-full md:w-64 flex flex-row md:flex-col items-center md:items-end justify-between md:justify-center gap-8 md:pl-16 md:border-l border-slate-100">
                                    <div class="text-right">
                                        <div class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3">Unit Valuation</div>
                                        <div class="text-5xl font-black text-[#00143D] italic">$${f.price}</div>
                                    </div>
                                    <a href="booking.html?id=${doc.id}&type=flight" class="btn-orange px-10 py-6 rounded-full font-black tracking-[0.3em] text-[10px] transition-all shadow-2xl text-center uppercase active:scale-95">Link Node</a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            // Stacking ScrollTrigger
            const cards = gsap.utils.toArray(".stack-item");
            cards.forEach((card, i) => {
                if (i === cards.length - 1) return;

                ScrollTrigger.create({
                    trigger: card,
                    start: "top 250px",
                    endTrigger: "#results-stack",
                    end: "bottom bottom",
                    pin: true,
                    pinSpacing: false,
                    scrub: true,
                    onUpdate: (self) => {
                        const scale = 1 - (self.progress * 0.05);
                        gsap.set(card.querySelector('.flight-card-inner'), {
                            scale: scale,
                            opacity: 1 - (self.progress * 0.4),
                            filter: `blur(${self.progress * 10}px)`
                        });
                    }
                });
            });

            gsap.from(".stack-item", {
                opacity: 0,
                y: 100,
                stagger: 0.15,
                duration: 1.5,
                ease: "expo.out"
            });
        });

        window.addEventListener('load', () => {
            gsap.from(".reveal-up", { y: 40, opacity: 0, duration: 1.2, ease: "power4.out" });
            gsap.from(".reveal-left", { x: -30, opacity: 0, duration: 1.2, ease: "power4.out", delay: 0.2 });

            // Handle Entrance Curtain
            gsap.to("#page-curtain", { left: "-100%", duration: 1.2, ease: "expo.inOut" });

            // Exit Hijack back to Home
            document.querySelectorAll('a[href="index.html"]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    gsap.to("#page-curtain", {
                        left: 0,
                        duration: 1,
                        ease: "expo.inOut",
                        onComplete: () => window.location.href = "index.html"
                    });
                });
            });
        });
    </script>
</body>

</html>